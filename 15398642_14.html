<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>A RENDITION OF THE TRENCH SAGA</title>
  <link rel="icon" type="image/png" href="./favicon.png">
 <style>
  :root{
    --bg:#000;
    --fg:#fff;
  }

  html,body{height:100%;margin:0;}
  body{
    background:var(--bg);
    color:var(--fg);
    font-family:"Courier New",monospace;
    display:flex;
    align-items:center;
    justify-content:center;
    padding:20px;
  }

  .wrap{
    text-align:center;
    width:100%;
    max-width:900px;
  }

  /* TITLE — FIXED WIDTH TYPEWRITER */
  /* TITLE — TWO-LINE TYPEWRITER */
h1{
  margin:0 0 1.5rem;
  font-size:clamp(2rem,6vw,4rem);
  letter-spacing:0.1em;
  white-space:normal;           /* ← permite salto de línea */
  text-align:center;
  line-height:1.2;
  display:inline-block;
  overflow:hidden;
  border-right:2px solid rgba(255,255,255,0.8);
  width: 26ch;                  /* ← ajustado para 2 líneas */
  animation: typing 3s steps(26,end), blink .7s step-end infinite;
}

@keyframes typing{ from{width:0;} to{width:26ch;} }
@keyframes blink{ 50%{border-color:transparent;} }

  /* INPUTS */
input[type="text"]{
  background:#000;
  color:#fff;
  border:1px solid rgba(255,255,255,0.22);
  padding:0.7rem 1rem;
  border-radius:8px;
  min-width:360px;     /* ← más ancho */
  max-width:420px;     /* ← evita romper diseño */
  font-size:1rem;
  transition: box-shadow .25s ease;
}

  button{
    background:#111;
    color:#fff;
    border:1px solid rgba(255,255,255,0.22);
    padding:0.7rem 1rem;
    border-radius:8px;
    cursor:pointer;
    font-size:1rem;
  }

  .input-row{
    display:flex;
    gap:0.6rem;
    justify-content:center;
    flex-wrap:wrap;
    margin-bottom:1rem;
  }

  /* FIXED PULSE EFFECT — NOW CLEARLY VISIBLE */
  .pulse-green{
    box-shadow:
      0 0 12px 4px rgba(0,255,0,0.55),
      0 0 28px 10px rgba(0,255,0,0.25);
  }

  .pulse-red{
    box-shadow:
      0 0 12px 4px rgba(255,0,0,0.55),
      0 0 28px 10px rgba(255,0,0,0.25);
  }

  .pulse-yellow{
    box-shadow:
      0 0 14px 4px rgba(255,255,0,0.60),
      0 0 30px 12px rgba(255,255,0,0.25);
  }

  .pulse-bishop{
    box-shadow:
      0 0 14px 4px rgba(255,60,60,0.60),
      0 0 30px 12px rgba(255,60,60,0.25);
  }

  #final{ margin-top:1rem; }
</style>

</head>
<body>
  <main class="wrap" role="main" aria-live="polite">
    <h1>
  A RENDITION OF THE<br>
  TRENCH SAGA
</h1>


    <!-- Step 1 -->
    <div id="step1" class="step">
      <div class="input-row">
        <input id="q1" type="text" placeholder="rebel red..." aria-label="Question 1">
        <button id="b1" aria-label="Enter 1">Enter</button>
      </div>
    </div>

    <!-- Step 2 -->
    <div id="step2" class="step" style="display:none;">
      <div class="input-row">
        <input id="q2" type="text" placeholder="Keons, Sacarver, Listo, Lisden, Reisdro, Vetomo, Andre, Nills..." aria-label="Question 2">
        <button id="b2" aria-label="Enter 2">Enter</button>
      </div>
    </div>

    <!-- Step 3 -->
    <div id="step3" class="step" style="display:none;">
      <div class="input-row">
        <input id="q3" type="text" placeholder="yellow inferno" aria-label="Question 3">
        <button id="b3" aria-label="Enter 3">Enter</button>
      </div>
    </div>

    <!-- Step 4 -->
    <div id="step4" class="step" style="display:none;">
      <div class="input-row">
        <input id="q4" type="text" placeholder="dema's symbol" aria-label="Question 4">
        <button id="b4" aria-label="Enter 4">Enter</button>
      </div>
    </div>

    <!-- Step 5 -->
    <div id="step5" class="step" style="display:none;">
      <div class="input-row">
        <input id="q5" type="text" placeholder="nova's figure" aria-label="Question 5">
        <button id="b5" aria-label="Enter 5">Enter</button>
      </div>
    </div>

    <!-- Final -->
    <div id="final" style="display:none;">
      <div id="song" aria-live="polite"></div>
      <div style="margin-top:12px;">
        <button id="restart">Restart</button>
      </div>
    </div>
  </main>

  <!-- Sounds (external URLs so it works immediately) -->
  <audio id="sound-correct" preload="auto" src="https://assets.mixkit.co/sfx/preview/mixkit-unlock-game-notification-253.wav"></audio>
  <audio id="sound-final" preload="auto" src="https://assets.mixkit.co/sfx/preview/mixkit-sparkle-tone-482.mp3"></audio>
  <audio id="sound-wrong" preload="auto" src="https://assets.mixkit.co/sfx/preview/mixkit-video-game-big-failure-2039.wav"></audio>

  <script>
    // Helpers
    const norm = s => (s || '').trim().toLowerCase();

    const q1 = document.getElementById('q1');
    const q2 = document.getElementById('q2');
    const q3 = document.getElementById('q3');
    const q4 = document.getElementById('q4');
    const q5 = document.getElementById('q5');

    const b1 = document.getElementById('b1');
    const b2 = document.getElementById('b2');
    const b3 = document.getElementById('b3');
    const b4 = document.getElementById('b4');
    const b5 = document.getElementById('b5');

    const step1 = document.getElementById('step1');
    const step2 = document.getElementById('step2');
    const step3 = document.getElementById('step3');
    const step4 = document.getElementById('step4');
    const step5 = document.getElementById('step5');

    const final = document.getElementById('final');
    const song = document.getElementById('song');
    const restart = document.getElementById('restart');

    const soundCorrect = document.getElementById('sound-correct');
    const soundFinal = document.getElementById('sound-final');
    const soundWrong = document.getElementById('sound-wrong');

    function playIfAllowed(s){
      if(!s) return;
      s.currentTime = 0;
      const p = s.play();
      if(p && p.catch) p.catch(()=>{/* ignore autoplay errors */});
    }

   function pulse(el, cls){
  el.classList.remove('pulse-green','pulse-red','pulse-yellow','pulse-bishop');

  // Forzar reflow *real*
  void el.offsetHeight;

  el.classList.add(cls);

  // Mantener visible más tiempo
  setTimeout(()=>{
    el.classList.remove(cls);
  }, 600);
}


    // Allow Enter key for each
    [ [q1,b1], [q2,b2], [q3,b3], [q4,b4], [q5,b5] ].forEach(pair=>{
      const [input, btn] = pair;
      input.addEventListener('keydown', e=>{
        if(e.key === 'Enter'){ e.preventDefault(); btn.click(); }
      });
    });

    // Step 1: rebel red... -> carnation
    b1.addEventListener('click', ()=>{
      const v = norm(q1.value);
      if(v === 'carnation'){
        pulse(q1,'pulse-green'); playIfAllowed(soundCorrect);
        setTimeout(()=> { step1.style.display='none'; step2.style.display='block'; q2.focus(); }, 350);
      } else {
        pulse(q1,'pulse-red'); playIfAllowed(soundWrong);
      }
    });

    // Step 2: Keons... -> clancy
    b2.addEventListener('click', ()=>{
      const v = norm(q2.value);
      if(v === 'clancy'){
        pulse(q2,'pulse-green'); playIfAllowed(soundCorrect);
        setTimeout(()=> { step2.style.display='none'; step3.style.display='block'; q3.focus(); }, 350);
      } else {
        pulse(q2,'pulse-red'); playIfAllowed(soundWrong);
      }
    });

    // Step 3: yellow inferno -> trench
    b3.addEventListener('click', ()=>{
      const v = norm(q3.value);
      if(v === 'trench'){
        pulse(q3,'pulse-green'); playIfAllowed(soundCorrect);
        setTimeout(()=> { step3.style.display='none'; step4.style.display='block'; q4.focus(); }, 350);
      } else {
        pulse(q3,'pulse-red'); playIfAllowed(soundWrong);
      }
    });

    // Step 4: dema's symbol -> bandito
    b4.addEventListener('click', ()=>{
      const v = norm(q4.value);
      if(v === 'bandito'){
        pulse(q4,'pulse-green'); playIfAllowed(soundCorrect);
        setTimeout(()=> { step4.style.display='none'; step5.style.display='block'; q5.focus(); }, 350);
      } else {
        pulse(q4,'pulse-red'); playIfAllowed(soundWrong);
      }
    });

    // Step 5: nova's figure -> bishop (or accept 'bandito' for alternate flow?)
    b5.addEventListener('click', ()=>{
      const v = norm(q5.value);
      // accept 'bandito' or 'bishop' as choices, but here required answer is 'bishop'
      // We'll accept both to produce final song mapping per user's previous logic:
      if(!['bandito','bishop','obispo'].includes(v)){
        pulse(q5,'pulse-red'); playIfAllowed(soundWrong);
        return;
      }

      // show pulse color specific
      if(v === 'bandito'){
        pulse(q5,'pulse-yellow'); playIfAllowed(soundCorrect);
        setTimeout(()=> {
          step5.style.display='none';
          final.style.display='block';
          song.innerHTML = "<span style='color:yellow'>Song: Levitate</span>";
          playIfAllowed(soundFinal);
        }, 420);
      } else { // bishop / obispo
        pulse(q5,'pulse-bishop'); playIfAllowed(soundCorrect);
        setTimeout(()=> {
          step5.style.display='none';
          final.style.display='block';
          song.innerHTML = "<span style='color:red'>Song: City Walls</span>";
          playIfAllowed(soundFinal);
        }, 420);
      }
    });

    restart.addEventListener('click', ()=> location.reload());

    // autofocus first
    q1.focus();
  </script>
</body>
</html>







